<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">

    <xsd:element name="Forum" abstract="true">
	<xsd:complexType>
		<xsd:complexContent>
			<xsd:extension base="NamedComponentType">
				<xsd:sequence>
                        <xsd:element name="numOfConnected">
						<xsd:simpleType>
							<xsd:restriction base="xsd:int">
								<xsd:minInclusive value="0"></xsd:minInclusive>
							</xsd:restriction>
						</xsd:simpleType>
					</xsd:element>
					<xsd:sequence minOccurs="0" maxOccurs="unbounded">
						<xsd:element name="forumSubjects"
							type="SubjectType">
						</xsd:element>
					</xsd:sequence>
					<xsd:sequence minOccurs="0" maxOccurs="unbounded">
						<xsd:element name="registeredUsers"
							type="UserType">
						</xsd:element>
					</xsd:sequence>
				</xsd:sequence>
			</xsd:extension>
		</xsd:complexContent>
	</xsd:complexType>    
    </xsd:element>


	<xsd:simpleType name="ConnectionStatusType">
		<xsd:restriction base="xsd:string">
			<xsd:enumeration value="Connected"></xsd:enumeration>
			<xsd:enumeration value="Disconected"></xsd:enumeration>
		</xsd:restriction>
	</xsd:simpleType>

	<xsd:complexType name="NamedComponentType">
		<xsd:sequence>
			<xsd:element name="name" type="xsd:string"></xsd:element>
			<xsd:element name="description" type="xsd:string"></xsd:element>
			<xsd:element name="numOfMessages">
				<xsd:simpleType>
					<xsd:restriction base="xsd:int">
						<xsd:minInclusive value="0"></xsd:minInclusive>
					</xsd:restriction>
				</xsd:simpleType>
			</xsd:element>
		</xsd:sequence>
	</xsd:complexType>

	<xsd:complexType name="UserType">
		<xsd:sequence>
			<xsd:element name="username" type="xsd:string"></xsd:element>
            <xsd:element name="e-mail">
				<xsd:simpleType>
					<xsd:restriction base="xsd:string">
						<xsd:pattern value=".+(@).+"></xsd:pattern>
					</xsd:restriction>
				</xsd:simpleType>
			</xsd:element>
            <xsd:element name="password" type="xsd:string"></xsd:element>
			<xsd:element name="lastName" type="xsd:string"></xsd:element>
			<xsd:element name="firstName" type="xsd:string"></xsd:element>
			<xsd:element name="numOfPostedMessages" type="xsd:int"></xsd:element>
			<xsd:element name="connectionStatus"
				type="ConnectionStatusType">
			</xsd:element>
			<xsd:sequence minOccurs="0" maxOccurs="unbounded">
				<xsd:element name="postedMessages" type="MessageType"></xsd:element>
			</xsd:sequence>
		</xsd:sequence>
	</xsd:complexType>

	<xsd:complexType name="SubjectType">
		<xsd:complexContent>
			<xsd:extension base="NamedComponentType">
				<xsd:sequence>
					<xsd:element name="ansestorSubject"
						type="SubjectType" minOccurs="0" maxOccurs="1">
					</xsd:element>

					<xsd:sequence minOccurs="0" maxOccurs="unbounded">
						<xsd:element name="subSubjects"
							type="SubjectType">
						</xsd:element>
					</xsd:sequence>

					<xsd:sequence minOccurs="0" maxOccurs="unbounded">
						<xsd:element name="subThreads"
							type="ThreadType">
						</xsd:element>
					</xsd:sequence>

					<xsd:element name="numOfThreads">
						<xsd:simpleType>
							<xsd:restriction base="xsd:int">
								<xsd:minInclusive value="0"></xsd:minInclusive>
							</xsd:restriction>
						</xsd:simpleType>
					</xsd:element>
					
					<xsd:element name="lastAddedMessage"
						type="MessageType" minOccurs="0" maxOccurs="1">
					</xsd:element>
				</xsd:sequence>
			</xsd:extension>
		</xsd:complexContent>
	</xsd:complexType>
    
    <xsd:complexType name="MessageType">
    	<xsd:sequence>
    		<xsd:element name="messageID" type="xsd:int"></xsd:element>
    		<xsd:element name="author" type="UserType"></xsd:element>
    		<xsd:element name="title" type="xsd:string"></xsd:element>
    		<xsd:element name="content" type="xsd:string"></xsd:element>
    		<xsd:element name="date" type="xsd:date"></xsd:element>
    		<xsd:element name="time" type="xsd:time"></xsd:element>
            <xsd:element name="isReplyTo" type="MessageType" minOccurs="0" maxOccurs="1">
    		</xsd:element>
            <xsd:sequence minOccurs="0" maxOccurs="unbounded">
    			<xsd:element name="replies" type="MessageType"></xsd:element>
    		</xsd:sequence>
    	</xsd:sequence>
    </xsd:complexType>

    <xsd:complexType name="ThreadType">
    	<xsd:sequence>
    		<xsd:element name="startMessage" type="MessageType"></xsd:element>
    		<xsd:element name="lastMessage" type="MessageType"></xsd:element>
    		<xsd:element name="numOfViews">
    			<xsd:simpleType>
    				<xsd:restriction base="xsd:int">
    					<xsd:minInclusive value="0"></xsd:minInclusive>
    				</xsd:restriction>
    			</xsd:simpleType>
    		</xsd:element>
    		<xsd:element name="numOfResponses">
    			<xsd:simpleType>
    				<xsd:restriction base="xsd:int">
    					<xsd:minInclusive value="0"></xsd:minInclusive>
    				</xsd:restriction>
    			</xsd:simpleType>
    		</xsd:element>
    	</xsd:sequence>
    </xsd:complexType>
</xsd:schema>